# سیستم تست جامع ربات تلگرام و وب‌سایت ادمین

این سیستم برای بررسی صحت عملکرد ربات تلگرام و سایر بخش‌های نرم‌افزار طراحی شده است. تست‌ها به گونه‌ای طراحی شده‌اند که نیازی به اتصال واقعی به API تلگرام ندارند و می‌توانند به صورت مستقل اجرا شوند.

## فایل‌های تست

1. **simple_bot_test.py**: تست ساده برای بررسی وضعیت webhook ربات
2. **db_test.py**: تست ارتباط با دیتابیس و مدل‌های SQLAlchemy
3. **simple_handlers_test.py**: تست ساده برای بررسی ماژول‌های handlers و keyboards
4. **comprehensive_test.py**: تست جامع همه بخش‌های سیستم
5. **run_all_tests.py**: اجرای تمام تست‌ها به صورت یک‌جا

## نحوه‌ی اجرا

برای اجرای تمام تست‌ها به صورت یک‌جا، دستور زیر را اجرا کنید:

```bash
python run_all_tests.py
```

برای اجرای تست‌های خاص به صورت جداگانه:

```bash
python simple_bot_test.py  # تست وضعیت ربات
python db_test.py          # تست دیتابیس
python simple_handlers_test.py  # تست handlers
python comprehensive_test.py    # تست جامع
```

## خروجی تست‌ها

نتایج تست‌ها در کنسول نمایش داده می‌شوند و همچنین در فایل `test_results.log` ذخیره می‌شوند. در پوشه‌ی `test_results` می‌توانید خروجی کامل هر تست را مشاهده کنید.

## ساختار تست‌ها

هر تست به چند بخش تقسیم می‌شود:

1. **تست دیتابیس**: بررسی ارتباط با دیتابیس و ساختار جداول
2. **تست مدل‌ها**: بررسی مدل‌های SQLAlchemy و ارتباطات بین جداول
3. **تست داده‌ها**: بررسی وجود داده‌های اصلی مورد نیاز
4. **تست عملکرد**: بررسی وجود ماژول‌ها و توابع اصلی سیستم

## ملاحظات مهم

1. برای اجرای تست‌ها، متغیرهای محیطی `BOT_TOKEN` و `DATABASE_URL` باید تنظیم شده باشند.
2. اجرای تست‌ها تغییری در داده‌های دیتابیس ایجاد نمی‌کند و فقط داده‌ها را می‌خواند.
3. تست‌ها برای اطمینان از عملکرد صحیح سیستم طراحی شده‌اند و پس از هر تغییر در کد باید مجدداً اجرا شوند.
4. اگر ربات در حالت webhook تنظیم شده باشد، برای اجرای تست‌ها نیازی به تغییر تنظیمات نیست.

## مشکلات رایج

1. **خطای ارتباط با دیتابیس**: اطمینان حاصل کنید که متغیر محیطی `DATABASE_URL` به درستی تنظیم شده و دیتابیس در دسترس است.
2. **خطای دسترسی به ربات**: اطمینان حاصل کنید که متغیر محیطی `BOT_TOKEN` به درستی تنظیم شده و توکن معتبر است.
3. **خطای تایم‌اوت در تست‌ها**: اگر تست‌ها زمان زیادی می‌برند، می‌توانید زمان تایم‌اوت را در فایل `run_all_tests.py` افزایش دهید.